#!/bin/bash

. config
. control

TESTS=`cat ./testfile`
total=0
pass=0
fail=0
nottested=0

echo "	RESULTS:"

for i in `seq 1 $NUM_ITERATIONS`; do
    for TEST in $TESTS; do
	total=`expr $total + 1`

	TEST="$i.$TEST"
	LOG=`cat $RESULTS_DIR/\`ls $RESULTS_DIR/ 2>/dev/null | grep "^$TEST"\` 2>/dev/null`
	if [ $? != 0 ]; then
    		echo "$TEST:	NOT TESTED"
    		nottested=`expr $nottested + 1`
	else
	# We think that test pass if elfread prints word Magic	
		echo $LOG |grep "Magic" > /dev/null
		if [ $? == 0 ]; then
    			echo "$TEST:	PASS"
    			pass=`expr $pass + 1`
		else
    			echo "$TEST:	FAIL"
    			fail=`expr $fail + 1`
		fi
	fi
    done
done

echo "------------------"
echo "Total:	$total"
echo "Pass:	$pass"
echo "Fail:	$fail"
echo "NT:	$nottested"
