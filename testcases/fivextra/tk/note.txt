CSDL's modification to the test suite

1 ==================================================
constrains.tcl
==============
	    proc do {cmd {block 0}} {
		variable fd
		variable Data
		variable Done
		if {$block} {
		    fileevent $fd readable {}
		}
#		puts $fd "[list catch $cmd msg]; update; puts \$msg;\  ## modified by CSDL ##
#			puts **DONE**; flush stdout"
		puts $fd "package require Tk 8.4;[list catch $cmd msg]; update; puts \$msg;\
			puts **DONE**; flush stdout"
		flush $fd
		set Data {}
		if {$block} {
		    while {![eof $fd]} {
			set line [gets $fd]
			if {$line eq "**DONE**"} {
			    break
			}
			append Data $line
		    }
		} else {
		    set Done 0
		    vwait [namespace which -variable Done]
		}
		return $Data
	    }
	}




2.========================================================================
test image-1.10 {Tk_ImageCmd procedure, "create" option with "." as name} {
    set script [makeFile {
#	package require Tk 8.4 ##add by CSDL##
	package require Tk 8.4
	update
	puts [list [catch {image create photo .} msg] $msg]
	exit
    } script]
    set x [list [catch {exec [interpreter] <$script} msg] $msg]
    removeFile script
    set x
} {0 {1 {this isn't a Tk applicationNULL main window}}}

3.========================================================================
test select-10.1 {ConvertSelection procedure, race with selection clear} {unixOnly} {
    setup
    proc Ready {fd} {
	variable x
	lappend x [gets $fd]
    }
    set fd [open "|[list [interpreter] -geometry +0+0 -name tktest]" r+]

    puts $fd "puts foo; flush stdout"
    flush $fd
    gets $fd
    fileevent $fd readable [list Ready $fd]
    set selValue "Just a simple test"
    set selInfo ""
    selection handle .f1 {handler STRING}
    update
#    puts $fd {puts "[catch {selection get} msg] $msg"; puts **DONE**; flush stdout}   ## modified by CSDL ##
    puts $fd {package require Tk 8.4; puts "[catch {selection get} msg] $msg"; puts **DONE**; flush stdout}

    flush $fd;
    after 200
    selection own .
    set x {}
    vwait [namespace which -variable x]
    puts $fd {exit}
    flush $fd
#    close $fd   ## modified by CSDL ##
    catch { close $fd } msg    
    lappend x $selInfo
} {{1 PRIMARY selection doesn't exist or form "STRING" not defined} {}}


===================================================================================

testcases that may have problems
			
## Tk_BindEvent, MatchPatterns failed on XFree86 and fluxbox
##test_template bind.test
#test_template canvText.test		

## CanvasSetOrgin failed on XFree86 and fluxbox
##test_template canvas.test

## EntryWidgetCmd, ConfigureEntry, EntryComputeGeometry, InsertChars, EntrySetValue failed on XFree86 and fluxbox
##test_template entry.test 		
#test_template event.test			

## Tk_FocusCmd failed on fluxbox window manager
##test_template focus.test
#test_template focusTcl.test
#test_template font.test		
#test_template frame.test			

## Failed on XFree86 and fluxbox
##test_template grid.test	
#test_template image.test			
#test_template listbox.test 		
#test_template pack.test

## Faild in all condition
##test_template place.test
#test_template raise.test			

## Failed on XFree86 and fluxbox
##test_template scale.test
#test_template select.test			
#test_template send.test

## Failed on XFree86 and fluxbox
##test_template spinbox.test			
#test_template text.test	

## Failed on fluxbox window manager
##test_template textDisp.test			
#test_template textTag.test
#test_template textWind.test			

## Failed on Xfbdev and mwm
##test_template unixEmbed.test	
#test_template unixFont.test			
#test_template unixSelect.test		

## Faild in all condition
##test_template unixWm.test

## Only passed on mwm window manager
##test_template winfo.test
## Only passed on Xfbdev and mwm window manager
#test_template wm.test
